@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>来访需求信息申报（绿都员工填写）</title>
    <!-- Favicon-->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css">
    <!-- Bootstrap Core Css -->
    @*
        <link href="~/plugins/bootstrap/css/bootstrap.css" rel="stylesheet">*@
    <!-- Waves Effect Css -->
    @*
        <link href="~/plugins/node-waves/waves.css" rel="stylesheet" />*@
    <!-- Animation Css -->
    @*
        <link href="~/plugins/animate-css/animate.css" rel="stylesheet" />*@
    <!-- Morris Chart Css-->
    @*
        <link href="~/plugins/morrisjs/morris.css" rel="stylesheet" />*@
    <!-- Multi Select Css -->
    @*
        <link href="~/plugins/multi-select/css/multi-select.css" rel="stylesheet">*@
    <!-- Bootstrap Spinner Css -->
    @*
        <link href="~/plugins/jquery-spinner/css/bootstrap-spinner.css" rel="stylesheet">*@
    <!-- Bootstrap Select Css -->
    @*
        <link href="~/plugins/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" />*@
    <!-- Custom Css -->
    @*
        <link href="~/css/style.css" rel="stylesheet">*@
    <!-- AdminBSB Themes. You can choose a theme from css/themes instead of get all themes -->
    @*
        <link href="~/css/themes/all-themes.css" rel="stylesheet" />*@

    <!-- Bootstrap Core Css -->
    <link href="~/plugins/bootstrap/css/bootstrap.css" rel="stylesheet">
    <!-- Waves Effect Css -->
    <link href="~/plugins/node-waves/waves.css" rel="stylesheet" />
    <!-- Animation Css -->
    <link href="~/plugins/animate-css/animate.css" rel="stylesheet" />
    <!-- Colorpicker Css -->
    <link href="~/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.css" rel="stylesheet" />
    <!-- Dropzone Css -->
    <link href="~/plugins/dropzone/dropzone.css" rel="stylesheet">
    <!-- Multi Select Css -->
    <link href="~/plugins/multi-select/css/multi-select.css" rel="stylesheet">
    <!-- Bootstrap Spinner Css -->
    <link href="~/plugins/jquery-spinner/css/bootstrap-spinner.css" rel="stylesheet">
    <!-- Bootstrap Tagsinput Css -->
    <link href="~/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet">
    <!-- Bootstrap Select Css -->
    <link href="~/plugins/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" />
    <!-- noUISlider Css -->
    <link href="~/plugins/nouislider/nouislider.min.css" rel="stylesheet" />
    <!-- Custom Css -->
    <link href="~/css/style.css" rel="stylesheet">
    <!-- AdminBSB Themes. You can choose a theme from css/themes instead of get all themes -->
    <link href="~/css/themes/all-themes.css" rel="stylesheet" />

    <style>
        .card .body {
            font-size: 14px;
            color: #555;
            padding: 10px;
        }

        .card label {
            font-size: 1.2em;
        }

        .card input {
            font-size: 1.2em;
        }

        .card textarea {
            font-size: 1.2em;
        }

        section.content {
            margin: 60px 15px 0 315px;
            -moz-transition: 0.5s;
            -o-transition: 0.5s;
            -webkit-transition: 0.5s;
            transition: 0.5s;
        }

        .card {
            background: #fff;
            min-height: 50px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            position: relative;
            margin-bottom: 30px;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            -ms-border-radius: 2px;
            border-radius: 2px;
            margin-top: 60px;
        }

        .info-box-3 {
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            height: 80px;
            display: flex;
            cursor: default;
            background-color: #fff;
            position: relative;
            overflow: hidden;
            margin-bottom: 10px;
        }
    </style>
</head>
<body class="theme-indigo">


    <!-- Page Loader -->
    <div class="page-loader-wrapper">
        <div class="loader">
            <div class="preloader">
                <div class="spinner-layer pl-red">
                    <div class="circle-clipper left">
                        <div class="circle"></div>
                    </div>
                    <div class="circle-clipper right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
            <p>Please wait...</p>
        </div>
    </div>
    <!-- #END# Page Loader -->
    <!-- Overlay For Sidebars -->
    <div class="overlay"></div>
    <!-- #END# Overlay For Sidebars -->
    <!-- Search Bar -->
    @*<div class="search-bar">
            <div class="search-icon">
                <i class="material-icons">search</i>
            </div>
            <input type="text" placeholder="搜索名称/事业部">
            <div class="close-search">
                <i class="material-icons">close</i>
            </div>
        </div>*@
    <!-- #END# Search Bar -->
    <!-- Top Bar -->
    <nav class="navbar">
        <div class="container-fluid">
            <div class="navbar-header">
                <img src="~/images/logo.png" width="140" height="40" />
                @*<a href="javascript:void(0);" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"></a>*@
                @*<a href="javascript:void(0);" class="navbar-toggle js-search" data-close="true"><i class="material-icons">search</i></a>*@

                @*<a href="javascript:void(0);" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"></a>*@

                @*<a href="javascript:void(0);" class="bars"></a>*@
                <a class="" style="color: #ffffff; font-size: 16px;margin-left:15px;" href="index.html">|</a>
                <a class="" style="color: #ffffff; font-weight: bold; font-size: 18px;margin-left:10px;" href="index.html">访客申报</a>
                @*<a class="navbar-brand" href="index.html">ADMINBSB - MATERIAL DESIGN</a>*@

                @*<a onclick="copyText()"><i class="material-icons pull-right col-blue">content_copy</i> </a>*@
            </div>
            <div class="collapse navbar-collapse" id="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <!-- Call Search -->
                    @*
                        <li class="pull-right"><a href="javascript:void(0);" class="js-search" data-close="true"><i class="material-icons">search</i></a></li>*@
                    <!-- #END# Call Search -->
                    <!-- Notifications -->
                    <!-- #END# Notifications -->
                    <!-- Tasks -->
                    <!-- #END# Tasks -->

                </ul>
            </div>
        </div>
    </nav>
    <!-- #Top Bar -->



    <div class="card">
        @{
            System.Data.DataTable dtPermission = (System.Data.DataTable)ViewData["dsPermission"];
            <div class="header">
                <h2>
                    @ViewData["title"]
                </h2>
                @*<small>
                        <div style="padding:0px 15px 0px 15px; background-color: #f5f5f5; ">
                            <br />
                            尊敬的绿都员工：<br />
                            &nbsp; &nbsp; &nbsp; &nbsp; 绿都地产为应对疫情影响，积极安排相关措施，降低疫情对后续项目的负面影响，需各员工对供应商来访需求信息进行申报。感谢您对绿都地产一如既往的支持！ <br />
                            <br />
                            绿都地产<br />
                            二O二O年三月九日<br />
                            <br />
                        </div>
                    </small>*@
                <ul class="header-dropdown m-r--5">
                    <li class="dropdown">
                        <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                            <i class="material-icons">more_vert</i>
                        </a>
                        <ul class="dropdown-menu pull-right">
                            <li><a href="Employee">来访申报</a></li>
                            @*<li><a href="EmployeeList">我发起</a></li>*@


                            @if (dtPermission.Rows.Count > 0)
                            {
                                <li><a href="EmployRole?page=all&type=Untreated">查看全部</a></li>
                            }
                            @*<li><a href="EmployRole?page=all&type=Untreated">查看全部</a></li>*@



                            @*
        <li><a href="javascript:void(0);">Action</a></li>
        <li><a href="javascript:void(0);">Another action</a></li>
        <li><a href="javascript:void(0);">Something else here</a></li>*@
                        </ul>
                    </li>
                </ul>

            </div>
        }
        @{
            System.Data.DataTable dt = (System.Data.DataTable)ViewData["ds"];

            <div class="body">

                @*<div class="info-box-3 bg-indigo hover-zoom-effect">
                        <div class="icon">
                            <i class="material-icons">transfer_within_a_station</i>
                        </div>
                        <div class="content">
                            <div class="text">近期来访数</div>
                            <div class="number">
                                @dt.Rows.Count
                            </div>
                        </div>
                    </div>*@
                @*@if (Convert.ToInt32(ViewData["VisitorsCount"]) > 0)
                    {
                    <div class="info-box-3 bg-indigo hover-zoom-effect">
                        <div class="icon">
                            <i class="material-icons">people</i>
                        </div>
                        <div class="content">
                            <div class="text">来访总人数</div>
                            <div class="number">@ViewData["VisitorsCount"] </div>
                        </div>
                    </div>
                    }
                    @if (Convert.ToInt32(ViewData["UnhealthyCount"]) > 0)
                    {
                    <div class="info-box-3 bg-red hover-zoom-effect">
                        <div class="icon">
                            <i class="material-icons">person_outline</i>
                        </div>
                        <div class="content">
                            <div class="text">异常人数</div>
                            <div class="number">@ViewData["UnhealthyCount"] </div>
                        </div>
                    </div>
                    }*@
                @*未处理来访数*@
                @if (Convert.ToInt32(ViewData["Untreated"]) > 0)
                {
                    <div class="info-box-3 bg-orange hover-zoom-effect" onclick="intoEmployeeList('Untreated')">
                        <div class="icon">
                            <i class="material-icons">people_outline</i>
                        </div>
                        <div class="content">
                            <div class="text">未处理来访数</div>
                            <div class="number">@ViewData["Untreated"] </div>
                        </div>
                    </div>
                }
                @*将来访人数*@
                @if (Convert.ToInt32(ViewData["WillVisit"]) > 0)
                {
                    <div class="info-box-3 bg-light-green hover-zoom-effect" onclick="intoEmployeeList('WillVisit')">
                        <div class="icon">
                            <i class="material-icons">person_add</i>
                        </div>
                        <div class="content">
                            <div class="text">将来访人数</div>
                            <div class="number">@ViewData["WillVisit"] </div>
                        </div>
                    </div>
                }
                @*已来访人数*@
                @if (Convert.ToInt32(ViewData["Visited"]) > 0)
                {
                    <div class="info-box-3 bg-indigo hover-zoom-effect" onclick="intoEmployeeList('Visited')">
                        <div class="icon">
                            <i class="material-icons">people</i>
                        </div>
                        <div class="content">
                            <div class="text">已来访人数</div>
                            <div class="number">@ViewData["Visited"] </div>
                        </div>
                    </div>
                }
                @*来访异常人数*@
                @if (Convert.ToInt32(ViewData["Abnormal"]) > 0)
                {
                    <div class="info-box-3 bg-red hover-zoom-effect" onclick="intoEmployeeList('Abnormal')">
                        <div class="icon">
                            <i class="material-icons">person_outline</i>
                        </div>
                        <div class="content">
                            <div class="text">来访异常人数</div>
                            <div class="number">@ViewData["Abnormal"] </div>
                        </div>
                    </div>
                }


                <div class="list-group">
                    @{
                        if (dt.Rows.Count > 0)
                        {
                            for (int i = 0; i < dt.Rows.Count; i++)
                            {
                                int days = ((TimeSpan)(System.DateTime.Now - Convert.ToDateTime(dt.Rows[i]["VisitDate"]))).Days;
                                if (days > 0 && days < 7)
                                {
                                    <a href="~/YQ/EmployeeInfo?Code=@dt.Rows[i]["id"]" class="list-group-item">
                                        @*active*@
                                        <h4 class="list-group-item-heading" style="color: #4caf50; ">
                                            @Convert.ToDateTime(dt.Rows[i]["VisitDate"]).ToString("d") @dt.Rows[i]["VisitTime"]
                                            <span style="color: #4caf50; font-size: 1.0rem;">@(days)天</span> 

                                        </h4>

                                        <p class="list-group-item-text">@dt.Rows[i]["SupplierName"] @dt.Rows[i]["NumVisitors"]人 @dt.Rows[i]["Address"] </p>
                                        @if (Convert.ToInt32(dt.Rows[i]["Num"]) > 0)
                                        {<span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem; ">√ @dt.Rows[i]["Num"]访客已申报 </span>}
                                        &nbsp;
                                        @if (dt.Rows[i]["Type1"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo1"].ToString() != String.Empty)
                                            {
                                                <span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">@(dt.Rows[i]["YesOrNo1"].ToString() == "1" ? "已来访" : "未来访") </span>}
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type2"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo2"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">7天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo2"].ToString() == "0")
                                            {
                                                <span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">7天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type3"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo3"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">14天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo3"].ToString() == "0")
                                            {
                                                <span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">14天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                    </a>
                                }
                                else if (days >= 7 && days < 14)
                                {
                                    <a href="~/YQ/EmployeeInfo?Code=@dt.Rows[i]["id"]" class="list-group-item">
                                        @*active*@
                                        <h4 class="list-group-item-heading" style="color: #ff9800">
                                            @Convert.ToDateTime(dt.Rows[i]["VisitDate"]).ToString("d") @dt.Rows[i]["VisitTime"]
                                            <span style="color: #ff9800; font-size: 1.0rem; ">@(days)天</span>

                                        </h4>

                                        <p class="list-group-item-text">@dt.Rows[i]["SupplierName"] @dt.Rows[i]["NumVisitors"]人 @dt.Rows[i]["Address"] </p>
                                        @if (Convert.ToInt32(dt.Rows[i]["Num"]) > 0)
                                        {<span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem; ">√ @dt.Rows[i]["Num"]访客已申报 </span>}
                                        &nbsp;
                                        @if (dt.Rows[i]["Type1"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo1"].ToString() != String.Empty)
                                            {<span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">@(dt.Rows[i]["YesOrNo1"].ToString() == "1" ? "已来访" : "未来访") </span>}
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type2"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo2"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">7天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo2"].ToString() == "0")
                                            {
                                                <span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">7天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type3"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo3"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">14天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo3"].ToString() == "0")
                                            {
                                                <span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">14天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                    </a>
                                }
                                else if (days >= 14)
                                {
                                    <a href="~/YQ/EmployeeInfo?Code=@dt.Rows[i]["id"]" class="list-group-item">
                                        @*active*@
                                        <h4 class="list-group-item-heading" style="color: #ff5722">
                                            @Convert.ToDateTime(dt.Rows[i]["VisitDate"]).ToString("d") @dt.Rows[i]["VisitTime"]
                                            <span style="color: #ff5722; font-size: 1.0rem; ">@(days)天</span>

                                        </h4>

                                        <p class="list-group-item-text">@dt.Rows[i]["SupplierName"] @dt.Rows[i]["NumVisitors"]人 @dt.Rows[i]["Address"] </p>
                                        @if (Convert.ToInt32(dt.Rows[i]["Num"]) > 0)
                                        {<span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem; ">√ @dt.Rows[i]["Num"]访客已申报 </span>}
                                        &nbsp;
                                        @if (dt.Rows[i]["Type1"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo1"].ToString() != String.Empty)
                                            {<span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">@(dt.Rows[i]["YesOrNo1"].ToString() == "1" ? "已来访" : "未来访") </span>}
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type2"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo2"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">7天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo2"].ToString() == "0")
                                            {
                                                <span style="background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">7天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                        @if (dt.Rows[i]["Type3"] != null)
                                        {
                                            if (dt.Rows[i]["YesOrNo3"].ToString() == "1")
                                            {<span style=" background-color: red; color: #ddd; font-size: 1.0rem;">14天异常 </span>}
                                            else if (dt.Rows[i]["YesOrNo3"].ToString() == "0")
                                            {
                                                <span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem;">14天正常 </span>
                                            }
                                        }
                                        &nbsp;
                                    </a>
                                }
                                else
                                {
                                    <a href="~/YQ/EmployeeInfo?Code=@dt.Rows[i]["id"]" class="list-group-item">
                                        @*active*@
                                        <h4 class="list-group-item-heading">
                                            @Convert.ToDateTime(dt.Rows[i]["VisitDate"]).ToString("d") @dt.Rows[i]["VisitTime"]

                                        </h4>
                                        <p class="list-group-item-text">@dt.Rows[i]["SupplierName"] @dt.Rows[i]["NumVisitors"]人 @dt.Rows[i]["Address"]</p>

                                        @if (Convert.ToInt32(dt.Rows[i]["Num"]) > 0)
                                        {<span style=" background-color: #3f51b5; color: #ddd; font-size: 1.0rem; ">√ @dt.Rows[i]["Num"]访客已申报 </span>}
                                        &nbsp;
                                    </a>
                                }
                            }
                        }
                    }



                    @*<a href="javascript:void(0);" class="list-group-item">
                            <h4 class="list-group-item-heading">2020-3-11 9:00-10:00</h4>
                            <p class="list-group-item-text">盟拓软件苏州有限公司 3人 到明基广场B栋7楼 来访</p>
                        </a>*@
                </div>




            </div>
        }
    </div>

    <!-- Small Size -->
    <div class="modal fade" id="smallModal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="smallModalLabel">请将链接和随机码发送给您的访客</h4>
                </div>
                <div class="modal-body">
                    <b>
                        第一步：来访前
                    </b><br />
                    通过提供的链接填写来访相关信息<br />
                    链接：<div id="url">http://kpxx.lvdu-dc.com:82/YQ/CustomerBef?Code=</div>
                    <br /><br />
                    <b>
                        第二步：来访时
                    </b><br />
                    扫描到访公司门前的二维码，填写当日来访信息<br />
                </div>
                <div class="modal-footer">

                    <button type="button" class="btn btn-link waves-effect" onclick="copyText()">复制内容</button>
                    <button type="button" class="btn btn-link waves-effect" data-dismiss="modal">关闭</button>
                </div>
                @*测试弹出层提示复制成功*@
                <div class="row clearfix jsdemo-notification-button">
                    <button id="btnCopyAlert" style="opacity: 0;fliter: alpha(opacity=0);" type="button" class="btn bg-blue btn-block waves-effect" data-placement-from="bottom" data-placement-align="left"
                            data-animate-enter="" data-animate-exit="" data-color-name="bg-blue">
                        BLUE
                    </button>
                </div>
            </div>
        </div>
        <textarea id="inputContent" style="opacity: 0;fliter: alpha(opacity=0);">
            @*第一步：来访前
                通过提供的链接填写来访相关信息
                链接：http://kpxx.lvdu-dc.com:82/YQ/CustomerBef?Code=
                第二步：来访时
                扫描到访公司门前的二维码，填写当日来访信息*@
        </textarea>
    </div>
    @*<div>@ViewData["code"] </div>*@



    <script type="text/javascript">

        window.onload = function () {
            //加载复制事件
            $('.jsdemo-notification-button button').on('click', function () {
                var placementFrom = $(this).data('placement-from');
                var placementAlign = $(this).data('placement-align');
                var animateEnter = $(this).data('animate-enter');
                var animateExit = $(this).data('animate-exit');
                var colorName = $(this).data('color-name');

                showNotification(colorName, "复制成功", placementFrom, placementAlign, animateEnter, animateExit);
            });
        }

        //选择“申请来访公司”后修改“申请来访地点”
        function VisitCompany_onchange() {
            var VisitCompany = $("#VisitCompany option:selected").text();
            //alert(VisitCompany);
            $.post("/YQ/GetAddress", {
                VisitCompany: VisitCompany

            }, function (response) {
                var list = $.parseJSON(response);
                //alert(response);
                var Address = document.getElementById("Address");
                $("#Address").empty();
                Address.options.add(new Option("请选择...", "请选择..."));
                //遍历集合显示数据
                for (var i = 0; i < list.length; i++) {
                    //alert(list[i].Address);
                    Address.options.add(new Option(list[i].Address, list[i].Address));
                }
                //使用refresh方法更新UI以匹配新状态。
                $('#Address').selectpicker('refresh');
                //render方法强制重新渲染引导程序 - 选择ui。
                $('#Address').selectpicker('render');


            });
        }


        //员工申报来访信息
        function EmployeeSubmit_onclick() {
            //var company = $("#company").val();
            //var influence = $("#influence option:selected").text();

            //获取控件值
            var Company = $("#Company").val();
            var Department = $("#Department").val();
            var UserName = $("#UserName").val();
            var IsDeclare = $("#IsDeclare option:selected").text();

            var Reason = $("#Reason").val();
            var VisitCompany = $("#VisitCompany").val();
            var Address = $("#Address").val();
            var VisitDate = $("#VisitDate").val();

            var VisitTime = $("#VisitTime").val();
            var NumVisitors = $("#NumVisitors").val();
            var SupplierName = $("#SupplierName").val();

            //必填项验证
            if (Company == "" || Department == "" || UserName == "" || IsDeclare == "请选择..."
                   || Reason == "" || VisitCompany == "请选择..." || Address == "请选择..." || VisitDate == "" || VisitTime == ""
                   || NumVisitors == "" || SupplierName == ""
                   ) {
                alert("请填写必填项！");
                return;
            }

            //“申请来访日期”格式验证
            isDate(VisitDate);
            //“来访人数”格式验证
            if ($.isNumeric(NumVisitors) == false) {
                alert("请填写正确的“来访人数”！");
                return;
            }

            //提交
            $.post("/YQ/AddEmployee", {
                Company: Company,
                Department: Department,
                UserName: UserName,
                IsDeclare: IsDeclare,
                Reason: Reason,
                VisitCompany: VisitCompany,
                Address: Address,
                VisitDate: VisitDate,
                VisitTime: VisitTime,
                NumVisitors: NumVisitors,
                SupplierName: SupplierName
            }, function (response) {

                if (response == '提交失败！') {
                    alert(response);
                }
                else {
                    //alert(response);
                    document.getElementById("url").innerHTML = 'http://kpxx.lvdu-dc.com:82/YQ/CustomerBef?Code=' + response;
                    document.getElementById("inputContent").value = '第一步：来访前';
                    document.getElementById("inputContent").value += '\n通过提供的链接填写来访相关信息';
                    document.getElementById("inputContent").value += "\n链接：http://kpxx.lvdu-dc.com:82/YQ/CustomerBef?Code=" + response
                    document.getElementById("inputContent").value += '\n\n第二步：来访时';
                    document.getElementById("inputContent").value += '\n扫描到访公司门前的二维码，填写当日来访信息';

                    document.getElementById("btnContent").click();
                }
            });

        }

        //复制
        function copyText() {
            var input = document.getElementById("inputContent");
            input.select(); // 选中文本
            document.execCommand("copy"); // 执行浏览器复制命令
            //alert("复制成功");

            document.getElementById("btnContent").click();
            document.getElementById("btnCopyAlert").click();
        }

        //验证日期格式
        function isDate(dateString) {
            if (dateString.trim() == "") {
                alert("请输入日期");
                return false;
            }
            var r = dateString.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);
            if (r == null) {
                alert("请输入格式正确的日期\n\r日期格式：yyyy-mm-dd\n\r例    如：2020-01-01\n\r");
                return false;
            }
            var d = new Date(r[1], r[3] - 1, r[4]);
            var num = (d.getFullYear() == r[1] && (d.getMonth() + 1) == r[3] && d.getDate() == r[4]);
            if (num == 0) {
                alert("请输入格式正确的日期\n\r日期格式：yyyy-mm-dd\n\r例    如：2020-01-01\n\r");
            }
            return (num != 0);
        }

        // 验证手机号格式
        function isPhoneNo(phone) {
            var pattern = /^1[34578]\d{9}$/;
            return pattern.test(phone);
        }

        //弹出复制提示框
        function showNotification(colorName, text, placementFrom, placementAlign, animateEnter, animateExit) {

            if (colorName === null || colorName === '') { colorName = 'bg-black'; }
            if (text === null || text === '') { text = 'Turning standard Bootstrap alerts'; }
            if (animateEnter === null || animateEnter === '') { animateEnter = 'animated fadeInDown'; }
            if (animateExit === null || animateExit === '') { animateExit = 'animated fadeOutUp'; }
            var allowDismiss = true;

            $.notify({
                message: text
            },
                {
                    type: colorName,
                    allow_dismiss: allowDismiss,
                    newest_on_top: true,
                    timer: 1000,
                    placement: {
                        from: placementFrom,
                        align: placementAlign
                    },
                    animate: {
                        enter: animateEnter,
                        exit: animateExit
                    },
                    template: '<div data-notify="container" class="bootstrap-notify-container alert alert-dismissible {0} ' + (allowDismiss ? "p-r-35" : "") + '" role="alert">' +
                    '<button type="button" aria-hidden="true" class="close" data-notify="dismiss">×</button>' +
                    '<span data-notify="icon"></span> ' +
                    '<span data-notify="title">{1}</span> ' +
                    '<span data-notify="message">{2}</span>' +
                    '<div class="progress" data-notify="progressbar">' +
                    '<div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div>' +
                    '</div>' +
                    '<a href="{3}" target="{4}" data-notify="url"></a>' +
                    '</div>'
                });

        }

        var windowHeight = $(window).height(),
             $body = $("body");
        $body.css("height", windowHeight);
        var startX, startY, moveEndX, moveEndY, X, Y;

        $("body").on("touchstart", function (e) {
            e.preventDefault();
            startX = e.originalEvent.changedTouches[0].pageX,
            startY = e.originalEvent.changedTouches[0].pageY;
        });

        $("body").on("touchmove", function (e) {
            e.preventDefault();
            moveEndX = e.originalEvent.changedTouches[0].pageX,
            moveEndY = e.originalEvent.changedTouches[0].pageY,
            X = moveEndX - startX,
            Y = moveEndY - startY;

            if (Math.abs(X) > Math.abs(Y) && X > 0) {
                alert("像右滑动");
            }
            else if (Math.abs(X) > Math.abs(Y) && X < 0) {
                alert("像左滑动");
            }
            else if (Math.abs(Y) > Math.abs(X) && Y > 0) {
                alert("下滑动");
            }
            else if (Math.abs(Y) > Math.abs(X) && Y < 0) {
                alert("上滑动");
            }
            else {
                alert("触摸");
            }
        });

        //跳转
        function intoEmployeeList(type) {
            window.location.href = "/YQ/EmployeeList?page=all&type=" + type;
        }
    </script>



    <!-- Jquery Core Js -->
    <script src="~/plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap Core Js -->
    <script src="~/plugins/bootstrap/js/bootstrap.js"></script>
    <!-- Select Plugin Js -->
    <script src="~/plugins/bootstrap-select/js/bootstrap-select.js"></script>
    <!-- Slimscroll Plugin Js -->
    <script src="~/plugins/jquery-slimscroll/jquery.slimscroll.js"></script>
    <!-- Bootstrap Colorpicker Js -->
    <script src="~/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
    <!-- Dropzone Plugin Js -->
    <script src="~/plugins/dropzone/dropzone.js"></script>
    <!-- Input Mask Plugin Js -->
    <script src="~/plugins/jquery-inputmask/jquery.inputmask.bundle.js"></script>
    <!-- Multi Select Plugin Js -->
    <script src="~/plugins/multi-select/js/jquery.multi-select.js"></script>
    <!-- Jquery Spinner Plugin Js -->
    <script src="~/plugins/jquery-spinner/js/jquery.spinner.js"></script>
    <!-- Bootstrap Tags Input Plugin Js -->
    <script src="~/plugins/bootstrap-tagsinput/bootstrap-tagsinput.js"></script>
    <!-- noUISlider Plugin Js -->
    <script src="~/plugins/nouislider/nouislider.js"></script>
    <!-- Waves Effect Plugin Js -->
    <script src="~/plugins/node-waves/waves.js"></script>
    <!-- Bootstrap Notify Plugin Js -->
    <script src="~/plugins/bootstrap-notify/bootstrap-notify.js"></script>
    <!-- Custom Js -->
    <script src="~/js/admin.js"></script>
    <script src="~/js/pages/forms/advanced-form-elements.js"></script>
    <!-- Jquery Validation Plugin Css -->
    <script src="~/plugins/jquery-validation/jquery.validate.js"></script>
    <!-- Demo Js -->
    <script src="~/js/demo.js"></script>
</body>
</html>
